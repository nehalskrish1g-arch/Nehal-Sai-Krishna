<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knapsack Algorithm Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        code, pre {
            font-family: 'Fira Code', monospace;
        }
        
        .code-line {
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 0.25rem;
        }
        
        .code-line.active {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            font-weight: 500;
            transform: translateX(4px);
        }
        
        .code-line.completed {
            background: #f0fdf4;
            color: #166534;
        }
        
        .item-card {
            transition: all 0.3s ease;
        }
        
        .item-card.selected {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }
        
        .dp-cell {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .dp-cell.active {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            transform: scale(1.1);
            z-index: 10;
        }
        
        .dp-cell.updated {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .dp-cell.comparing {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .control-btn {
            transition: all 0.2s ease;
        }
        
        .control-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .control-btn:active:not(:disabled) {
            transform: translateY(0);
        }
        
        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .7;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">0/1 Knapsack Algorithm Visualizer</h1>
                    <p class="text-blue-100 mt-1">Interactive Dynamic Programming Visualization</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-blue-100">Algorithm Type</div>
                    <div class="text-xl font-semibold">Dynamic Programming</div>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <!-- Input Section -->
        <div class="glass-effect rounded-xl shadow-xl p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Problem Setup</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Knapsack Capacity</label>
                    <input type="number" id="capacity" value="10" min="1" max="20" 
                           class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Animation Speed (ms)</label>
                    <input type="range" id="speed" min="100" max="2000" value="800" step="100"
                           class="w-full">
                    <div class="text-center text-sm text-gray-600 mt-1"><span id="speedDisplay">800</span> ms</div>
                </div>
            </div>
            
            <div class="mt-6">
                <label class="block text-sm font-semibold text-gray-700 mb-2">Items (Weight, Value)</label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3" id="itemsInput">
                    <!-- Items will be generated here -->
                </div>
                <div class="mt-3 flex gap-2">
                    <button onclick="addItem()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">
                        + Add Item
                    </button>
                    <button onclick="generateRandomItems()" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition">
                        üé≤ Random Items
                    </button>
                </div>
            </div>

            <button onclick="startVisualization()" id="startBtn"
                    class="mt-6 w-full control-btn px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold text-lg hover:bg-blue-700">
                Start Visualization
            </button>
        </div>

        <!-- Main Visualization Area -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Code Panel -->
            <div class="glass-effect rounded-xl shadow-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Pseudocode</h2>
                    <div class="flex items-center gap-2">
                        <span class="text-sm font-semibold text-gray-600">Step:</span>
                        <span id="stepCounter" class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full font-bold">0</span>
                    </div>
                </div>
                
                <div class="bg-gray-900 rounded-lg p-4 overflow-auto max-h-96" id="codePanel">
                    <pre class="text-sm"><code id="pseudocode"></code></pre>
                </div>

                <!-- Controls -->
                <div class="mt-6 flex gap-3 flex-wrap">
                    <button onclick="play()" id="playBtn" disabled
                            class="control-btn flex-1 px-4 py-2 bg-green-500 text-white rounded-lg font-semibold">
                        ‚ñ∂ Play
                    </button>
                    <button onclick="pause()" id="pauseBtn" disabled
                            class="control-btn flex-1 px-4 py-2 bg-yellow-500 text-white rounded-lg font-semibold">
                        ‚è∏ Pause
                    </button>
                    <button onclick="stepForward()" id="stepBtn" disabled
                            class="control-btn flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold">
                        ‚è≠ Step
                    </button>
                    <button onclick="reset()" id="resetBtn" disabled
                            class="control-btn flex-1 px-4 py-2 bg-red-500 text-white rounded-lg font-semibold">
                        ‚Ü∫ Reset
                    </button>
                </div>

                <!-- Complexity Analysis -->
                <div class="mt-6 p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border-2 border-purple-200">
                    <h3 class="font-bold text-gray-800 mb-2">Complexity Analysis</h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <span class="text-gray-600">Time Complexity:</span>
                            <div class="font-bold text-purple-700">O(n √ó W)</div>
                        </div>
                        <div>
                            <span class="text-gray-600">Space Complexity:</span>
                            <div class="font-bold text-blue-700">O(n √ó W)</div>
                        </div>
                    </div>
                    <div class="mt-3 text-xs text-gray-600">
                        n = number of items, W = knapsack capacity
                    </div>
                </div>
            </div>

            <!-- Visualization Panel -->
            <div class="glass-effect rounded-xl shadow-xl p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Visualization</h2>
                
                <!-- Current Step Explanation -->
                <div class="mb-4 p-4 bg-blue-50 rounded-lg border-2 border-blue-200">
                    <h3 class="font-bold text-blue-800 mb-2">Current Step:</h3>
                    <p id="stepExplanation" class="text-sm text-gray-700">Initialize the visualization to begin</p>
                </div>

                <!-- Items Display -->
                <div class="mb-6">
                    <h3 class="font-semibold text-gray-700 mb-3">Available Items:</h3>
                    <div id="itemsDisplay" class="flex flex-wrap gap-3">
                        <!-- Items will be displayed here -->
                    </div>
                </div>

                <!-- DP Table -->
                <div class="overflow-auto max-h-96">
                    <h3 class="font-semibold text-gray-700 mb-3">DP Table:</h3>
                    <div id="dpTable" class="inline-block">
                        <!-- DP table will be generated here -->
                    </div>
                </div>

                <!-- Result Display -->
                <div id="resultDisplay" class="mt-6 p-4 bg-green-50 rounded-lg border-2 border-green-200 hidden">
                    <h3 class="font-bold text-green-800 mb-2">Result:</h3>
                    <div class="text-2xl font-bold text-green-700 mb-2">
                        Maximum Value: <span id="maxValue">0</span>
                    </div>
                    <div class="text-sm text-gray-700">
                        <strong>Selected Items:</strong> <span id="selectedItems"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let state = {
            items: [{weight: 2, value: 3}, {weight: 3, value: 4}, {weight: 4, value: 5}, {weight: 5, value: 6}],
            capacity: 10,
            dp: [],
            currentStep: 0,
            steps: [],
            isPlaying: false,
            isPaused: false,
            speed: 800,
            animationTimeout: null
        };

        // Pseudocode lines
        const pseudocode = [
            'function knapsack(items, capacity):',
            '    n = length(items)',
            '    dp[0...n][0...capacity] = 0',
            '    ',
            '    for i from 1 to n:',
            '        for w from 0 to capacity:',
            '            if items[i-1].weight > w:',
            '                dp[i][w] = dp[i-1][w]',
            '            else:',
            '                include = dp[i-1][w-weight] + value',
            '                exclude = dp[i-1][w]',
            '                dp[i][w] = max(include, exclude)',
            '    ',
            '    return dp[n][capacity]'
        ];

        // Initialize
        function init() {
            renderPseudocode();
            renderItemsInput();
            updateSpeedDisplay();
            
            document.getElementById('speed').addEventListener('input', (e) => {
                state.speed = parseInt(e.target.value);
                updateSpeedDisplay();
            });
        }

        function renderPseudocode() {
            const codeElement = document.getElementById('pseudocode');
            codeElement.innerHTML = pseudocode.map((line, i) => 
                `<div class="code-line" id="code-line-${i}">${line}</div>`
            ).join('');
        }

        function updateSpeedDisplay() {
            document.getElementById('speedDisplay').textContent = state.speed;
        }

        function renderItemsInput() {
            const container = document.getElementById('itemsInput');
            container.innerHTML = state.items.map((item, i) => `
                <div class="flex items-center gap-2 bg-white p-2 rounded border">
                    <input type="number" value="${item.weight}" min="1" max="20"
                           onchange="updateItem(${i}, 'weight', this.value)"
                           class="w-16 px-2 py-1 border rounded text-sm" placeholder="W">
                    <input type="number" value="${item.value}" min="1" max="50"
                           onchange="updateItem(${i}, 'value', this.value)"
                           class="w-16 px-2 py-1 border rounded text-sm" placeholder="V">
                    <button onclick="removeItem(${i})" class="text-red-500 hover:text-red-700">√ó</button>
                </div>
            `).join('');
        }

        function updateItem(index, field, value) {
            state.items[index][field] = parseInt(value);
        }

        function addItem() {
            if (state.items.length < 10) {
                state.items.push({weight: 1, value: 1});
                renderItemsInput();
            }
        }

        function removeItem(index) {
            if (state.items.length > 1) {
                state.items.splice(index, 1);
                renderItemsInput();
            }
        }

        function generateRandomItems() {
            const count = Math.floor(Math.random() * 4) + 3; // 3-6 items
            state.items = [];
            for (let i = 0; i < count; i++) {
                state.items.push({
                    weight: Math.floor(Math.random() * 8) + 1,
                    value: Math.floor(Math.random() * 15) + 5
                });
            }
            renderItemsInput();
        }

        function startVisualization() {
            state.capacity = parseInt(document.getElementById('capacity').value);
            state.currentStep = 0;
            state.isPlaying = false;
            state.isPaused = false;
            
            // Generate steps
            generateSteps();
            
            // Initialize DP table
            initializeDPTable();
            
            // Display items
            displayItems();
            
            // Enable controls
            document.getElementById('startBtn').disabled = true;
            document.getElementById('playBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('resetBtn').disabled = false;
            
            // Show first step
            visualizeStep(0);
        }

        function generateSteps() {
            state.steps = [];
            const n = state.items.length;
            const W = state.capacity;
            
            // Initialize DP array
            const dp = Array(n + 1).fill(0).map(() => Array(W + 1).fill(0));
            
            // Step: Initialization
            state.steps.push({
                line: 2,
                explanation: `Initializing DP table with dimensions [${n+1}][${W+1}]. All cells start at 0.`,
                i: -1,
                w: -1,
                action: 'init'
            });
            
            // Main algorithm
            for (let i = 1; i <= n; i++) {
                for (let w = 0; w <= W; w++) {
                    const item = state.items[i - 1];
                    
                    state.steps.push({
                        line: 6,
                        explanation: `Checking item ${i} (weight=${item.weight}, value=${item.value}) for capacity ${w}`,
                        i: i,
                        w: w,
                        action: 'check',
                        itemIndex: i - 1
                    });
                    
                    if (item.weight > w) {
                        dp[i][w] = dp[i - 1][w];
                        state.steps.push({
                            line: 7,
                            explanation: `Item ${i} is too heavy (${item.weight} > ${w}). Exclude it: dp[${i}][${w}] = ${dp[i][w]}`,
                            i: i,
                            w: w,
                            action: 'exclude',
                            value: dp[i][w],
                            itemIndex: i - 1
                        });
                    } else {
                        const include = dp[i - 1][w - item.weight] + item.value;
                        const exclude = dp[i - 1][w];
                        
                        state.steps.push({
                            line: 10,
                            explanation: `Item ${i} fits! Include: ${include} (from dp[${i-1}][${w-item.weight}] + ${item.value}), Exclude: ${exclude}`,
                            i: i,
                            w: w,
                            action: 'compare',
                            include: include,
                            exclude: exclude,
                            itemIndex: i - 1
                        });
                        
                        dp[i][w] = Math.max(include, exclude);
                        
                        state.steps.push({
                            line: 11,
                            explanation: `Choose maximum: dp[${i}][${w}] = ${dp[i][w]}`,
                            i: i,
                            w: w,
                            action: 'update',
                            value: dp[i][w],
                            itemIndex: i - 1
                        });
                    }
                }
            }
            
            // Final step
            state.steps.push({
                line: 13,
                explanation: `Algorithm complete! Maximum value: ${dp[n][W]}`,
                i: n,
                w: W,
                action: 'complete',
                maxValue: dp[n][W]
            });
            
            state.dp = dp;
        }

        function initializeDPTable() {
            const n = state.items.length;
            const W = state.capacity;
            const tableContainer = document.getElementById('dpTable');
            
            let html = '<table class="border-collapse">';
            
            // Header row
            html += '<tr><th class="border-2 border-gray-300 bg-gray-200 px-3 py-2 text-xs font-bold">i/w</th>';
            for (let w = 0; w <= W; w++) {
                html += `<th class="border-2 border-gray-300 bg-gray-200 px-3 py-2 text-xs font-bold">${w}</th>`;
            }
            html += '</tr>';
            
            // Data rows
            for (let i = 0; i <= n; i++) {
                html += '<tr>';
                html += `<th class="border-2 border-gray-300 bg-gray-200 px-3 py-2 text-xs font-bold">${i}</th>`;
                for (let w = 0; w <= W; w++) {
                    html += `<td class="dp-cell border-2 border-gray-300 px-3 py-2 text-center text-sm font-semibold bg-white" id="cell-${i}-${w}">0</td>`;
                }
                html += '</tr>';
            }
            
            html += '</table>';
            tableContainer.innerHTML = html;
        }

        function displayItems() {
            const container = document.getElementById('itemsDisplay');
            container.innerHTML = state.items.map((item, i) => `
                <div class="item-card bg-white px-4 py-3 rounded-lg border-2 border-gray-300 shadow" id="item-${i}">
                    <div class="text-xs text-gray-600 font-semibold">Item ${i + 1}</div>
                    <div class="text-sm"><strong>W:</strong> ${item.weight}</div>
                    <div class="text-sm"><strong>V:</strong> ${item.value}</div>
                </div>
            `).join('');
        }

        function visualizeStep(stepIndex) {
            if (stepIndex >= state.steps.length) {
                complete();
                return;
            }
            
            const step = state.steps[stepIndex];
            state.currentStep = stepIndex;
            
            // Update step counter
            document.getElementById('stepCounter').textContent = stepIndex + 1;
            
            // Update code highlighting
            document.querySelectorAll('.code-line').forEach(line => {
                line.classList.remove('active', 'completed');
            });
            
            const codeLine = document.getElementById(`code-line-${step.line}`);
            if (codeLine) {
                codeLine.classList.add('active');
                gsap.fromTo(codeLine, 
                    { x: -10, opacity: 0.5 }, 
                    { x: 0, opacity: 1, duration: 0.3 }
                );
            }
            
            // Update explanation
            document.getElementById('stepExplanation').textContent = step.explanation;
            gsap.fromTo('#stepExplanation', 
                { opacity: 0, y: -10 }, 
                { opacity: 1, y: 0, duration: 0.4 }
            );
            
            // Update items display
            document.querySelectorAll('.item-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            if (step.itemIndex !== undefined) {
                const itemCard = document.getElementById(`item-${step.itemIndex}`);
                if (itemCard) {
                    itemCard.classList.add('selected');
                    gsap.fromTo(itemCard, 
                        { scale: 1 }, 
                        { scale: 1.05, duration: 0.3 }
                    );
                }
            }
            
            // Update DP table
            if (step.i >= 0 && step.w >= 0) {
                // Clear previous highlights
                document.querySelectorAll('.dp-cell').forEach(cell => {
                    cell.classList.remove('active', 'updated', 'comparing');
                });
                
                const cell = document.getElementById(`cell-${step.i}-${step.w}`);
                
                if (step.action === 'check') {
                    cell.classList.add('active');
                    gsap.fromTo(cell, 
                        { scale: 1 }, 
                        { scale: 1.1, duration: 0.3, yoyo: true, repeat: 1 }
                    );
                } else if (step.action === 'compare') {
                    cell.classList.add('comparing');
                } else if (step.action === 'update' || step.action === 'exclude') {
                    cell.textContent = step.value;
                    cell.classList.add('updated');
                    gsap.fromTo(cell, 
                        { scale: 1.2, backgroundColor: '#10b981' }, 
                        { scale: 1, backgroundColor: '#10b981', duration: 0.5 }
                    );
                }
            }
        }

        function play() {
            if (state.currentStep >= state.steps.length - 1) {
                reset();
                return;
            }
            
            state.isPlaying = true;
            state.isPaused = false;
            document.getElementById('playBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            
            playNext();
        }

        function playNext() {
            if (!state.isPlaying || state.currentStep >= state.steps.length - 1) {
                state.isPlaying = false;
                document.getElementById('playBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = true;
                return;
            }
            
            state.currentStep++;
            visualizeStep(state.currentStep);
            
            state.animationTimeout = setTimeout(playNext, state.speed);
        }

        function pause() {
            state.isPlaying = false;
            state.isPaused = true;
            clearTimeout(state.animationTimeout);
            document.getElementById('playBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
        }

        function stepForward() {
            if (state.currentStep < state.steps.length - 1) {
                state.currentStep++;
                visualizeStep(state.currentStep);
            }
        }

        function reset() {
            state.isPlaying = false;
            state.isPaused = false;
            state.currentStep = 0;
            clearTimeout(state.animationTimeout);
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('playBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('stepBtn').disabled = true;
            document.getElementById('resetBtn').disabled = true;
            
            document.getElementById('resultDisplay').classList.add('hidden');
            document.getElementById('stepCounter').textContent = '0';
            document.getElementById('stepExplanation').textContent = 'Initialize the visualization to begin';
            
            document.querySelectorAll('.code-line').forEach(line => {
                line.classList.remove('active', 'completed');
            });
            
            document.querySelectorAll('.dp-cell').forEach(cell => {
                cell.classList.remove('active', 'updated', 'comparing');
            });
            
            document.querySelectorAll('.item-card').forEach(card => {
                card.classList.remove('selected');
            });
        }

        function complete() {
            state.isPlaying = false;
            const maxValue = state.dp[state.items.length][state.capacity];
            
            // Find selected items
            const selectedItems = [];
            let i = state.items.length;
            let w = state.capacity;
            
            while (i > 0 && w > 0) {
                if (state.dp[i][w] !== state.dp[i - 1][w]) {
                    selectedItems.unshift(i);
                    w -= state.items[i - 1].weight;
                }
                i--;
            }
            
            document.getElementById('maxValue').textContent = maxValue;
            document.getElementById('selectedItems').textContent = selectedItems.join(', ');
            document.getElementById('resultDisplay').classList.remove('hidden');
            
            gsap.fromTo('#resultDisplay', 
                { scale: 0.8, opacity: 0 }, 
                { scale: 1, opacity: 1, duration: 0.5, ease: 'back.out(1.7)' }
            );
            
            document.getElementById('playBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('stepBtn').disabled = true;
        }

        // Initialize on load
        init();
    </script>
</body>
</html>